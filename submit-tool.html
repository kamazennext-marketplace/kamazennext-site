<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Submit a Tool - Kama ZenNext</title>
  <link rel="stylesheet" href="/assets/css/styles.css?v=20260106">
  <link rel="stylesheet" href="/assets/css/theme-light.css?v=20260106">
  <link rel="stylesheet" href="/assets/theme.css?v=1">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <script src="/assets/js/header.js" defer></script>
  <script src="/assets/js/mobile-nav.js" defer></script>
  <script src="/assets/js/security.js"></script>
</head>
<body>
  <div id="site-header"></div>

  <main class="section">
    <div class="container" style="max-width: 960px;">
      <div class="breadcrumbs">
        <ol>
          <li><a href="/">Home</a></li>
          <li>Submit a tool</li>
        </ol>
      </div>
      <div class="card">
        <h1 style="margin-top:0;">Submit your tool for review</h1>
        <p class="helper">We're curating listings and will reach out once we've reviewed your submission.</p>
        <form id="submitForm" class="form-grid" novalidate>
          <label>Name*
            <input type="text" name="name" required aria-required="true">
          </label>
          <label>Email*
            <input type="email" name="email" required aria-required="true">
          </label>
          <label>Tool name*
            <input type="text" name="tool_name" required aria-required="true">
          </label>
          <label>Tool URL*
            <input type="url" name="tool_url" required aria-required="true" placeholder="https://example.com">
          </label>
          <label>Category
            <select name="category" id="categorySelect">
              <option value="">Select a category (optional)</option>
            </select>
          </label>
          <label class="hidden-field">Company
            <input type="text" name="company" tabindex="-1" autocomplete="off">
          </label>
          <label class="full">Message
            <textarea name="message" placeholder="Share context, highlights, and who it's best for."></textarea>
          </label>
          <div class="form-actions full">
            <button type="submit" id="submitBtn" class="btn btn-primary">Send submission</button>
          </div>
          <div id="formAlert" role="status" aria-live="polite" class="full"></div>
        </form>
      </div>
    </div>
  </main>

  <script type="module">
    const form = document.getElementById('submitForm');
    const submitBtn = document.getElementById('submitBtn');
    const alertBox = document.getElementById('formAlert');
    const categorySelect = document.getElementById('categorySelect');

    const setAlert = (message, type = 'success') => {
      alertBox.className = `alert ${type} full`;
      alertBox.textContent = message;
    };

    const clearAlert = () => {
      alertBox.className = 'full';
      alertBox.textContent = '';
    };

    const populateCategories = async () => {
      try {
        const res = await fetch('/data/products.json');
        if (!res.ok) return;
        const products = await res.json();
        const categories = Array.from(new Set((products || []).map(p => p.category).filter(Boolean))).sort();
        categories.forEach(cat => {
          const opt = document.createElement('option');
          opt.value = cat;
          opt.textContent = cat;
          categorySelect.appendChild(opt);
        });
      } catch (err) {
        console.warn('Could not load categories', err);
      }
    };

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      clearAlert();
      submitBtn.disabled = true;
      submitBtn.textContent = 'Submitting...';
      const formData = new FormData(form);

      try {
        const response = await fetch('/api/submit-tool.php', {
          method: 'POST',
          body: formData
        });
        const result = await response.json().catch(() => ({ error: 'Unexpected response. Please try again.' }));
        if (response.ok && result.ok) {
          form.reset();
          setAlert('Thanks! Your tool has been submitted to the waitlist.', 'success');
        } else {
          setAlert(result.error || 'Unable to submit right now.', 'error');
        }
      } catch (err) {
        console.error(err);
        setAlert('Network error. Please try again.', 'error');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Send submission';
      }
    });

    populateCategories();
  </script>
</body>
</html>
